[user@localhost]$ vagrant up --provider virtualbox
The provider 'virtualbox' that was requested to back the machine
'default' is reporting that it isn't usable on this system. The
reason is shown below:

Vagrant has detected that you have a version of VirtualBox installed
that is not supported by this version of Vagrant. Please install one of
the supported versions listed below to use Vagrant:

4.0, 4.1, 4.2, 4.3, 5.0, 5.1 <<=== supprot for this is VirtualBox 5.1.30 !

A Vagrant update may also be available that adds support for the version
you specified. Please check www.vagrantup.com/downloads.html to download
the latest version.
[user@localhost]$ dnf install vagrant
Error: This command has to be run under the root user.
[user@localhost elce]$ sudo dnf install vagrant
[sudo] password for user: 
Last metadata expiration check: 2:05:13 ago on Sat 06 Jan 2018 09:35:51 AM CET.
Package vagrant-1.9.8-2.fc27.noarch is already installed, skipping.
Dependencies resolved.
Nothing to do.
Complete!
[user@localhost]$
_______

How to clone CIP projects from gitlab?
git clone https://gitlab.com/cip-project/cip-testing/board-at-desk-single-dev.git

Actually, the better option is to clone from GitHub:
https://github.com/ZoranStojsavljevic/CIP-test.git
_______

Here, there are two possibilities: To use preconfigured, and generic machines, which need to be configured

The true preconfigured virtual machines are in the following directory:

/homeuser/projects2/vagrant/VMs (it is NOT generic path, rather Zoran's one)
_______

[IMPORTANT - The following are just temporary debug traces, should be removed in the final version]

--- debug traces begin --->

[user@localhost debian9]$ cat importbox.sh 
#!/bin/bash
# Copyright (C) 2017, Codethink, Ltd., Robert Marshall
# Adopted file for Siemens AG CIP testing: Zoran Stojsavljevic
# SPDX-License-Identifier:	AGPL-3.0
# This program is free software: you can redistribute it and/or modify
# it under the terms of the GNU Affero General Public License as
# published by the Free Software Foundation, version 3.

# This program is distributed in the hope that it will be useful, but WITHOUT ANY
# WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A
# PARTICULAR PURPOSE. See the GNU Affero General Public License for more details.

# You should have received a copy of the GNU Affero General Public License along
# with this program. If not, see <http://www.gnu.org/licenses/>.

# check number of parameters
if [ $# -ne 2 ] ; then
	echo "Usage: $0 boxLocation boxNewName" >&2
	exit 1
fi
set -e
box=$1
boxname=$2
vagrant box add $boxname $box
mv -f Vagrantfile Vagrantfile-tmp
vagrant init $boxname
mv Vagrantfile-tmp Vagrantfile
## sed -i Vagrantfile -e 's/debian\/stretch64/'"$box"'/'

# are any mods necessary?
set +e
vagrant up --provider virtualbox
echo The above should end with "==> default: KernelCI already configured remove ~/mybbb.dat to force configuration"
echo and a report that the ssh command responded with a non-zero exit status. This is expected!
echo
echo new KernelCI board at desk ready for use
[user@localhost debian9]$ vagrant box list
debian9          (virtualbox, 0)
generic/fedora27 (libvirt, 1.3.30)
generic/fedora27 (virtualbox, 1.3.30)
[user@localhost debian9]$ vagrant up --provider virtualbox
Bringing machine 'default' up with 'virtualbox' provider...
==> default: Box '../elce/cip_board_at_desk_v1.0.box' could not be found. Attempting to find and install...
    default: Box Provider: virtualbox
    default: Box Version: >= 0
==> default: Box file was not detected as metadata. Adding it directly...
==> default: Adding box '../elce/cip_board_at_desk_v1.0.box' (v0) for provider: virtualbox
    default: Unpacking necessary files from: file:///home/user/projects/vagrant/elce/cip_board_at_desk_v1.0.box
==> default: Successfully added box '../elce/cip_board_at_desk_v1.0.box' (v0) for 'virtualbox'!
==> default: Importing base box '../elce/cip_board_at_desk_v1.0.box'...
==> default: Matching MAC address for NAT networking...
==> default: Setting the name of the VM: debian9_default_1515245225847_1244
==> default: Clearing any previously set network interfaces...
==> default: Preparing network interfaces based on configuration...
    default: Adapter 1: nat
==> default: Forwarding ports...
    default: 22 (guest) => 2222 (host) (adapter 1)
==> default: Booting VM...
==> default: Waiting for machine to boot. This may take a few minutes...
    default: SSH address: 127.0.0.1:2222
    default: SSH username: vagrant
    default: SSH auth method: private key
==> default: Machine booted and ready!
==> default: Checking for guest additions in VM...
    default: No guest additions were detected on the base box for this VM! Guest
    default: additions are required for forwarded ports, shared folders, host only
    default: networking, and more. If SSH fails on this machine, please install
    default: the guest additions and repackage the box to continue.
    default: 
    default: This is not an error message; everything may continue to work properly,
    default: in which case you may ignore this message.
==> default: Mounting shared folders...
    default: /vagrant => /home/user/projects/vagrant/debian9
Vagrant was unable to mount VirtualBox shared folders. This is usually
because the filesystem "vboxsf" is not available. This filesystem is
made available via the VirtualBox Guest Additions and kernel module.
Please verify that these guest additions are properly installed in the
guest. This is not a bug in Vagrant and is usually caused by a faulty
Vagrant box. For context, the command attempted was:

mount -t vboxsf -o uid=1000,gid=1000 vagrant /vagrant

The error output from the command was:
_______

[user@localhost debian9]$

[user@localhost debian9]$ vagrant box remove debian9 
Removing box 'debian9' (v0) with provider 'virtualbox'...
Vagrant-libvirt plugin removed box only from you LOCAL ~/.vagrant/boxes directory
From libvirt storage pool you have to delete image manually(virsh, virt-manager or by any other tool)
[user@localhost debian9]$ vagrant box list
generic/fedora27 (libvirt, 1.3.30)
generic/fedora27 (virtualbox, 1.3.30)
[user@localhost debian9]$ time ./importbox.sh debian9 ../elce/cip_board_at_desk_v1.0.box
==> box: Box file was not detected as metadata. Adding it directly...
==> box: Adding box 'debian9' (v0) for provider: 
    box: Unpacking necessary files from: file:///home/user/projects/vagrant/elce/cip_board_at_desk_v1.0.box
==> box: Successfully added box 'debian9' (v0) for 'virtualbox'!
A `Vagrantfile` has been placed in this directory. You are now
ready to `vagrant up` your first virtual environment! Please read
the comments in the Vagrantfile as well as documentation on
`vagrantup.com` for more information on using Vagrant.
Bringing machine 'default' up with 'virtualbox' provider...
The above should end with ==> default: KernelCI already configured remove ~/mybbb.dat to force configuration
and a report that the ssh command responded with a non-zero exit status. This is expected!

new KernelCI board at desk ready for use

real	1m17.622s
user	0m10.636s
sys	0m4.807s
[user@localhost debian9]$
___________________________________________________________________

Here is first run for debian/stretch64 default load:

[user@localhost board-at-desk-single-dev]$ ./importbox.sh 
Usage: ./importbox.sh boxNewName pathToBoxLocation
Example: ./importbox.sh debian_stretch64 debian/stretch64
[user@localhost board-at-desk-single-dev]$ ./importbox.sh debian_stretch64 debian/stretch64
[1] Executing the command: vagrant box remove debian_stretch64
The box you requested to be removed could not be found. No
boxes named 'debian_stretch64' could be found.
[2] Executing the command: vagrant box list [to check which VMs remain]
debian9 (virtualbox, 0)
[3] Executing the command: vagrant box add debian_stretch64 debian/stretch64
==> box: Loading metadata for box 'debian/stretch64'
    box: URL: https://vagrantcloud.com/debian/stretch64
The box you're adding has a name different from the name you
requested. For boxes with metadata, you cannot override the name.
If you're adding a box using `vagrant box add`, don't specify
the `--name` parameter. If the box is being added via a Vagrantfile,
change the `config.vm.box` value to match the name below.

Requested name: debian_stretch64
Actual name: debian/stretch64
total 100
drwxr-xr-x. 10 user vboxusers  4096 Jan  9 14:41 .
drwxr-xr-x.  4 user vboxusers  4096 Jan  6 11:46 ..
drwxr-xr-x.  2 user vboxusers  4096 Oct 22 10:37 config
drwxr-xr-x.  2 user vboxusers  4096 Oct 22 10:37 device-dictionary
drwxr-xr-x.  2 user vboxusers  4096 Oct 22 10:37 device-types
drwxr-xr-x.  8 user vboxusers  4096 Jan  9 14:39 .git
-rw-r--r--.  1 user vboxusers    13 Oct 22 10:37 .gitignore
-rwxr-xr-x.  1 user user       2228 Jan  9 14:40 importbox.sh
-rw-r--r--.  1 user vboxusers  1299 Oct 22 10:37 importbox.sh.genesis
drwxr-xr-x.  2 user vboxusers  4096 Oct 22 10:37 integration-scripts
-rw-r--r--.  1 user vboxusers 33811 Oct 22 10:37 LICENSE
-rw-r--r--.  1 user vboxusers   949 Oct 22 10:37 LICENSE.spdx
-rw-r--r--.  1 user vboxusers  2902 Jan  9 14:32 README
drwxr-xr-x.  2 user vboxusers  4096 Oct 22 10:37 scripts
drwxr-xr-x.  3 user vboxusers  4096 Oct 22 10:37 tests
drwxr-xr-x.  3 user vboxusers  4096 Jan  6 11:10 .vagrant
-rw-r--r--.  1 user user       2481 Jan  9 14:33 Vagrantfile.genesis
[4] Executing the command: vagrant init debian_stretch64
A `Vagrantfile` has been placed in this directory. You are now
ready to `vagrant up` your first virtual environment! Please read
the comments in the Vagrantfile as well as documentation on
`vagrantup.com` for more information on using Vagrant.
[5] Executing the command: vagrant box list [to check if new VM is added]
debian9 (virtualbox, 0)
[6] Executing the command: vagrant up --provider virtualbox
Bringing machine 'default' up with 'virtualbox' provider...
==> default: Box 'debian/stretch64' could not be found. Attempting to find and install...
    default: Box Provider: virtualbox
    default: Box Version: >= 0
==> default: Loading metadata for box 'debian/stretch64'
    default: URL: https://vagrantcloud.com/debian/stretch64
==> default: Adding box 'debian/stretch64' (v9.3.0) for provider: virtualbox
    default: Downloading: https://vagrantcloud.com/debian/boxes/stretch64/versions/9.3.0/providers/virtualbox.box
==> default: Successfully added box 'debian/stretch64' (v9.3.0) for 'virtualbox'!
==> default: Importing base box 'debian/stretch64'...
==> default: Matching MAC address for NAT networking...
==> default: Checking if box 'debian/stretch64' is up to date...
==> default: Setting the name of the VM: board-at-desk-single-dev_default_1515506752297_69453
==> default: Clearing any previously set network interfaces...
==> default: Available bridged network interfaces:
1) wlo1
2) virbr0
3) enp0s25
==> default: When choosing an interface, it is usually the one that is
==> default: being used to connect to the internet.
    default: Which interface should the network bridge to? 1
==> default: Preparing network interfaces based on configuration...
    default: Adapter 1: nat
    default: Adapter 2: bridged
==> default: Forwarding ports...
    default: 8888 (guest) => 8888 (host) (adapter 1)
    default: 8010 (guest) => 8010 (host) (adapter 1)
    default: 5000 (guest) => 5000 (host) (adapter 1)
    default: 8080 (guest) => 8080 (host) (adapter 1)
    default: 443 (guest) => 4443 (host) (adapter 1)
    default: 22 (guest) => 2222 (host) (adapter 1)
==> default: Running 'pre-boot' VM customizations...
==> default: Booting VM...
==> default: Waiting for machine to boot. This may take a few minutes...
    default: SSH address: 127.0.0.1:2222
    default: SSH username: vagrant
    default: SSH auth method: private key
    default: 
    default: Vagrant insecure key detected. Vagrant will automatically replace
    default: this with a newly generated keypair for better security.
    default: 
    default: Inserting generated public key within guest...
    default: Removing insecure key from the guest if it's present...
    default: Key inserted! Disconnecting and reconnecting using new SSH key...
==> default: Machine booted and ready!
==> default: Checking for guest additions in VM...
    default: No guest additions were detected on the base box for this VM! Guest
    default: additions are required for forwarded ports, shared folders, host only
    default: networking, and more. If SSH fails on this machine, please install
    default: the guest additions and repackage the box to continue.
    default: 
    default: This is not an error message; everything may continue to work properly,
    default: in which case you may ignore this message.
==> default: Configuring and enabling network interfaces...
==> default: Installing rsync to the VM...
==> default: Rsyncing folder: /home/user/projects2/vagrant/elce/board-at-desk-single-dev/ => /vagrant
==> default: Running provisioner: shell...
    default: Running: inline script
==> default: /tmp/vagrant-shell: line 3: integration-scripts/install_ifupdown_workaround.sh: Permission denied
The SSH command responded with a non-zero exit status. Vagrant
assumes that this means the command failed. The output for this command
should be in the log above. Please read the output to determine what
went wrong.
The above should end with ==> default: KernelCI already configured remove ~/mybbb.dat to force configuration
and a report that the ssh command responded with a non-zero exit status. This is expected!

new KernelCI board at desk ready for use
[user@localhost board-at-desk-single-dev]$ vagrant box list
debian/stretch64 (virtualbox, 9.3.0)
debian9          (virtualbox, 0)
[user@localhost board-at-desk-single-dev]$ vagrant status
Current machine states:

default                   running (virtualbox)

The VM is running. To stop this VM, you can run `vagrant halt` to
shut it down forcefully, or you can run `vagrant suspend` to simply
suspend the virtual machine. In either case, to restart it again,
simply run `vagrant up`.
[user@localhost board-at-desk-single-dev]$ vagrant ssh
Linux stretch 4.9.0-4-amd64 #1 SMP Debian 4.9.65-3 (2017-12-03) x86_64

The programs included with the Debian GNU/Linux system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
vagrant@stretch:~$ uname -a
Linux stretch 4.9.0-4-amd64 #1 SMP Debian 4.9.65-3 (2017-12-03) x86_64 GNU/Linux
vagrant@stretch:~$
