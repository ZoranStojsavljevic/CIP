# Board at desk - single dev description  #

Board at desk - single dev (B@D) is an effort to ease the deployment of KernelCI and LAVAv2 allowing
a developer with a board connected to its machine to test kernels. 
In order to do so, a VM has been created with all the tools and configurations required. 
The current technology used to create that VM is Vagrant. 

# Interesting links #

This is a list of links you should check if you are interested in B@D:
* [Download](https://wiki.linuxfoundation.org/civilinfrastructureplatform/cipdownload) the latest version of the B@D box. Remember you can get the changes through Vagrant.
* Check what is new in the latest B@D release in the B@D [feature page](https://wiki.linuxfoundation.org/civilinfrastructureplatform/ciptestingboardatdesksingledevfeaturepage) and the instructions to deploy and configure B@D, connect the board to the VM and execute the reference tests.

# Contribute to the CIP testing project: #

If you are interested in contributing to this effort, please check the following resources:
* To learn more about the CIP testing project and how to contribute please check the [Landing Page](https://wiki.linuxfoundation.org/civilinfrastructureplatform/ciptesting)
* Please read the Testing at [CIP FAQ](https://wiki.linuxfoundation.org/civilinfrastructureplatform/ciptestingfaq) to learn more about this action.
* Join the technical mailing list ( [cip-dev](https://lists.cip-project.org/mailman/listinfo/cip-dev) ) to follow this effort or contact the developers.
* Report a [bug](https://gitlab.com/cip-project/cip-testing/testing/boards). 
_______

The public web page: https://gitlab.com/cip-project/cip-testing/board-at-desk-single-dev

This particular repo was cloned from the following repo: https://gitlab.com/cip-project/cip-testing/board-at-desk-single-dev/tree/master
with the command: git clone https://gitlab.com/cip-project/cip-testing/board-at-desk-single-dev.git

There are additional advances, made by owner of this particular GitHub repository (Zoran Stojsavljevic):

[1] The importbox.sh was renamed as import.sh.genesis, and the similar one created, with much better /bin bash script to automatize vagrant VM handling.
[2] The VM downloaded is one original from vagrant repo, called debian/stretch64 .
[3] Please, read modified import.sh, since it has vagrant setup in correct order of the execution.

There will be in the Future other changes, done to this setup.

LICENCE: This repo follows the original licence from: https://gitlab.com/cip-project/cip-testing/board-at-desk-single-dev/tree/master

GNU AFFERO GENERAL PUBLIC LICENSE 
Version 3, 19 November 2007
Copyright (C) 2007 Free Software Foundation, Inc. <http://fsf.org/>

DISCLAIMER: this repo owner have created for his own use, just to keep the documentation in course... Owner did not want to bother CIP architects with it!
_______

Here is the example how the better script does work (with one of the default vagrant boxes - debian/stretch64):

[user@localhost board-at-desk-single-dev]$ ./importbox.sh 
Usage: ./importbox.sh boxNewName pathToBoxLocation
Example: ./importbox.sh debian_stretch64 debian/stretch64
[user@localhost board-at-desk-single-dev]$ ./importbox.sh debian_stretch64 debian/stretch64
[1] Executing the command: vagrant box remove debian_stretch64
The box you requested to be removed could not be found. No
boxes named 'debian_stretch64' could be found.
[2] Executing the command: vagrant box list [to check which VMs remain]
debian9 (virtualbox, 0)
[3] Executing the command: vagrant box add debian_stretch64 debian/stretch64
==> box: Loading metadata for box 'debian/stretch64'
    box: URL: https://vagrantcloud.com/debian/stretch64
The box you're adding has a name different from the name you
requested. For boxes with metadata, you cannot override the name.
If you're adding a box using `vagrant box add`, don't specify
the `--name` parameter. If the box is being added via a Vagrantfile,
change the `config.vm.box` value to match the name below.

Requested name: debian_stretch64
Actual name: debian/stretch64
total 100
drwxr-xr-x. 10 user vboxusers  4096 Jan  9 14:41 .
drwxr-xr-x.  4 user vboxusers  4096 Jan  6 11:46 ..
drwxr-xr-x.  2 user vboxusers  4096 Oct 22 10:37 config
drwxr-xr-x.  2 user vboxusers  4096 Oct 22 10:37 device-dictionary
drwxr-xr-x.  2 user vboxusers  4096 Oct 22 10:37 device-types
drwxr-xr-x.  8 user vboxusers  4096 Jan  9 14:39 .git
-rw-r--r--.  1 user vboxusers    13 Oct 22 10:37 .gitignore
-rwxr-xr-x.  1 user user       2228 Jan  9 14:40 importbox.sh
-rw-r--r--.  1 user vboxusers  1299 Oct 22 10:37 importbox.sh.genesis
drwxr-xr-x.  2 user vboxusers  4096 Oct 22 10:37 integration-scripts
-rw-r--r--.  1 user vboxusers 33811 Oct 22 10:37 LICENSE
-rw-r--r--.  1 user vboxusers   949 Oct 22 10:37 LICENSE.spdx
-rw-r--r--.  1 user vboxusers  2902 Jan  9 14:32 README
drwxr-xr-x.  2 user vboxusers  4096 Oct 22 10:37 scripts
drwxr-xr-x.  3 user vboxusers  4096 Oct 22 10:37 tests
drwxr-xr-x.  3 user vboxusers  4096 Jan  6 11:10 .vagrant
-rw-r--r--.  1 user user       2481 Jan  9 14:33 Vagrantfile.genesis
[4] Executing the command: vagrant init debian_stretch64
A `Vagrantfile` has been placed in this directory. You are now
ready to `vagrant up` your first virtual environment! Please read
the comments in the Vagrantfile as well as documentation on
`vagrantup.com` for more information on using Vagrant.
[5] Executing the command: vagrant box list [to check if new VM is added]
debian9 (virtualbox, 0)
[6] Executing the command: vagrant up --provider virtualbox
Bringing machine 'default' up with 'virtualbox' provider...
==> default: Box 'debian/stretch64' could not be found. Attempting to find and install...
    default: Box Provider: virtualbox
    default: Box Version: >= 0
==> default: Loading metadata for box 'debian/stretch64'
    default: URL: https://vagrantcloud.com/debian/stretch64
==> default: Adding box 'debian/stretch64' (v9.3.0) for provider: virtualbox
    default: Downloading: https://vagrantcloud.com/debian/boxes/stretch64/versions/9.3.0/providers/virtualbox.box
==> default: Successfully added box 'debian/stretch64' (v9.3.0) for 'virtualbox'!
==> default: Importing base box 'debian/stretch64'...
==> default: Matching MAC address for NAT networking...
==> default: Checking if box 'debian/stretch64' is up to date...
==> default: Setting the name of the VM: board-at-desk-single-dev_default_1515506752297_69453
==> default: Clearing any previously set network interfaces...
==> default: Available bridged network interfaces:
1) wlo1
2) virbr0
3) enp0s25
==> default: When choosing an interface, it is usually the one that is
==> default: being used to connect to the internet.
    default: Which interface should the network bridge to? 1
==> default: Preparing network interfaces based on configuration...
    default: Adapter 1: nat
    default: Adapter 2: bridged
==> default: Forwarding ports...
    default: 8888 (guest) => 8888 (host) (adapter 1)
    default: 8010 (guest) => 8010 (host) (adapter 1)
    default: 5000 (guest) => 5000 (host) (adapter 1)
    default: 8080 (guest) => 8080 (host) (adapter 1)
    default: 443 (guest) => 4443 (host) (adapter 1)
    default: 22 (guest) => 2222 (host) (adapter 1)
==> default: Running 'pre-boot' VM customizations...
==> default: Booting VM...
==> default: Waiting for machine to boot. This may take a few minutes...
    default: SSH address: 127.0.0.1:2222
    default: SSH username: vagrant
    default: SSH auth method: private key
    default: 
    default: Vagrant insecure key detected. Vagrant will automatically replace
    default: this with a newly generated keypair for better security.
    default: 
    default: Inserting generated public key within guest...
    default: Removing insecure key from the guest if it's present...
    default: Key inserted! Disconnecting and reconnecting using new SSH key...
==> default: Machine booted and ready!
==> default: Checking for guest additions in VM...
    default: No guest additions were detected on the base box for this VM! Guest
    default: additions are required for forwarded ports, shared folders, host only
    default: networking, and more. If SSH fails on this machine, please install
    default: the guest additions and repackage the box to continue.
    default: 
    default: This is not an error message; everything may continue to work properly,
    default: in which case you may ignore this message.
==> default: Configuring and enabling network interfaces...
==> default: Installing rsync to the VM...
==> default: Rsyncing folder: /home/user/projects2/vagrant/elce/board-at-desk-single-dev/ => /vagrant
==> default: Running provisioner: shell...
    default: Running: inline script
==> default: /tmp/vagrant-shell: line 3: integration-scripts/install_ifupdown_workaround.sh: Permission denied
The SSH command responded with a non-zero exit status. Vagrant
assumes that this means the command failed. The output for this command
should be in the log above. Please read the output to determine what
went wrong.
The above should end with ==> default: KernelCI already configured remove ~/mybbb.dat to force configuration
and a report that the ssh command responded with a non-zero exit status. This is expected!

new KernelCI board at desk ready for use
[user@localhost board-at-desk-single-dev]$ vagrant box list
debian/stretch64 (virtualbox, 9.3.0)
debian9          (virtualbox, 0)
[user@localhost board-at-desk-single-dev]$ vagrant status
Current machine states:

default                   running (virtualbox)

The VM is running. To stop this VM, you can run `vagrant halt` to
shut it down forcefully, or you can run `vagrant suspend` to simply
suspend the virtual machine. In either case, to restart it again,
simply run `vagrant up`.
[user@localhost board-at-desk-single-dev]$ vagrant ssh
Linux stretch 4.9.0-4-amd64 #1 SMP Debian 4.9.65-3 (2017-12-03) x86_64

The programs included with the Debian GNU/Linux system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
vagrant@stretch:~$ uname -a
Linux stretch 4.9.0-4-amd64 #1 SMP Debian 4.9.65-3 (2017-12-03) x86_64 GNU/Linux
vagrant@stretch:~$
_______

Thank you,
Zoran Stojsavljevic
